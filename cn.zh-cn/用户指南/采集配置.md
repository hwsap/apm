# 采集配置<a name="apm_02_0012"></a>

为了减少内存、数据库、磁盘空间占用，您可以按需进行采集设置。采集设置对所选应用生效。

## 操作步骤<a name="se0c7108012564108ab9160d6fd145d05"></a>

1.  在左侧导航栏中选择“采集管理 \> 采集设置”。
2.  在“应用”下拉列表框中选择应用。
3.  单击![](figures/icon-采集开关1.png)打开采集开关。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >采集开关默认打开，当您不需要采集某个应用的调用链和拓扑数据时，可通过关闭采集开关来停止数据采集，以减少资源占用。  

4.  单击![](figures/智能采样.png)开启正常调用采集开关。

    为了降低采集探针性能消耗，当事务异常或调用时延大于拓扑[Apdex阈值](https://support.huaweicloud.com/usermanual-apm/apm_02_0016.html)时全采样。如果打开正常调用采集开关，正常调用抽样采样，如果关闭此开关，不采集正常调用。

5.  单击![](figures/icon-采集开关2.png)开启内存检测机制。

    为了避免业务极度繁忙时，采集探针对业务性能造成影响，可开启内存检测机制，使采集探针进入休眠状态。您还可以单击![](figures/icon-编辑2.png)，设置持续周期和内存占用。

    >![](public_sys-resources/icon-note.gif) **说明：**   
    >-   内存占用=java进程实际使用内存/可用内存上限  
    >-   可用内存上限：按照容器可用内存资源配额与JVM最大堆内存中较小一个值计算。JVM最大堆内存为参数“-Xmx”的值，若未设置则默认为JVM最大可用内存25%。  
    >-   采集探针停止采集时的内存占用应大于等于恢复采集时的内存占用。  

6.  单击![](figures/icon-采集开关3.png)开启TraceID开关。

    TraceID用来唯一标识调用链，开启后，系统会在您的日志文件中增加TraceID信息（如下截图红框所示），您可通过TraceID（例如，ffffffffe1c08cab、ffffffffe1c08cad、ffffffffe1c08cae）精准搜索调用链的日志信息。

    ![](figures/TraceID开关.png)

7.  单击![](figures/icon-采集开关4.png)开启SQL分析开关。

    该开关关闭后，不会影响调用链中的SQL数据，但您将无法正常使用SQL分析功能。

8.  设置忽略HTTP响应代码。

    为了避免探针误报正常调用链的诸如自定义返回码、异常等调用错误，快速准确地定位错误的调用链， 您可以设置该选项，错误记录表中将不记录被忽略的HTTP响应代码。单击![](figures/icon-编辑3.png)，输入被忽略的HTTP响应代码，单击![](figures/icon-输入2.png)。格式为逗号分割的数字HTTP响应代码。

9.  设置忽略错误和异常。

    为了避免探针误报正常调用链的诸如自定义返回码、异常等调用错误，快速准确地定位错误的调用链， 您可以设置该选项，错误记录表中将不记录被忽略的错误和异常。单击![](figures/icon-编辑4.png)，输入被忽略的错误和异常，单击![](figures/icon-输入3.png)。格式为逗号分隔的Java异常类名称字符串，缺省值为空。


